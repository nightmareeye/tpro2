# Долгосрочное домашнее задание (игра "Трон 2D")

## Этап I

### Цель

Необходимо разработать 2D-игру "Трон" на одном клиенте. 

### Инструменты

На этом и следующем этапе вам потребуется изучить и использовать следующие основные инструменты для разработки вашего 
приложения:

* IDE для разработки (CLion)
* Совместный GIT-репозиторий (см. [ПЗ по командной работе](pz04-teamwork.md))
* Библиотека SFML (см. [ПЗ по SFML](pz06-GUI-SFML.md))

### Задание

На этом этапе необходимо реализовать клиент-серверное desktop-приложение, где **клиент** отвечает за графическую 
отрисовку процесса игры, а **сервер** за основную логику (реагирует на события и т.п.).

#### Функционал, который должен быть реализован:
1. Игровое меню
    * кнопка **Начать** - даёт возможность выбрать игру с параметрами:
        * задание **имени** каждого игрока и его **цвета**
        * с **дополнительными способностями игроков** и возможностью выбора максимального количества способностей 
          у каждого игрока или **без них**
        * с **количеством раундов** или **быструю игру** 
    * кнопка **Настроки** - позволяет настроить **фон игры** и **раскладку клавиатуры** для игроков 
    * кнопка **Выход** - выдаёт диалоговое окно "Хотите выйти из игры?"
    * фоновая музыка
    * фон — динамичное изображение
2. Игровой процесс
    * возможность управлять своим персонажем для каждого игрока (раскладки "WASD", "стрелочки" и т.п.)
    * возможность поставить игру на паузу с отображением **диалогового окна**:
        * кнопка **Возобновить игру**
        * надпись **имени** (в **цвете** игрока) игрока, поставившего игру на паузу
        * кнопка **Выйти из игры**
        * кнопка **Рестарт**
    * реализация игровых "способностей":
        * замедление своего персонажа
        * ускорение персонажа противника
        * использовать каждую способность можно только один раз за игру (раунд)
    * визуальная часть:
        * отображение времени игры
        * отображение счёта игры (если это многораундовая игра)
        * отображение счётчика раундов (если это многораундовая игра)
        * отображение **имён** игроков с **цветами** и активными способностями (если способность была использована, 
          картинку отображать в серых тонах)
        * фон — статичный фон
    * фоновая музыка
    * по завершению игры вывод **диалогового окна**:
        * **имя** и **цвет** победителя
        * **счёт игры**, если это игра с несколькими раундами, или **время** игры, если это быстрая игра
        * кнопки **Выход** или **Рестарт**
    * логика игры:
        * игрок проигрывает, если встречается со своим или чужим **следом**
        * игрок проигрывает, если сталкивается с **препятствием**
        * объявляется **ничья**, если игроки столкнулись "лоб в лоб"
        * проходить в край карты **можно** — в таком случае игрок выходит с противоположной стороны карты
        * в **раундовом сражении** побеждает тот игрок, который выиграл **наибольшее** число раундов
3. Конфигурация игры
    * все важные конфиги игры хранить в файлах — это может быть как файл JSON 
      ([см. ПЗ по запросам](./../pz10-requests.md#json-for-modern-c)), так и любой другой формат хранения — на выбор разработчиков
    * в конфигах должна содержаться вся информация из вкладки **Настройки** игрового меню и различные параметры игрового
      процесса: пути к фоновой музыке, фоновым изображениям, раскладки игроков и т.п. При этом, в случае если конфиг
      утерян, необходимо прописать в коде **настройки по умолчанию**, либо иным разумным способом обработать эту ситуацию
      
### Командная разработка

Далее пошагово представлен процесс реализации игры на этапе I. Каждый из членов команды выбирает себе задание, 
согласовав этот шаг разработки с остальными участниками команды. Шаги разработки составлены так, что **лучше всего**
для команды — полностью закрыть все задачи **конкретного** шага, прежде чем переходить к **следующему** шагу (тут вам 
потребуется командная работа).

На каждом шаге разработки ожидается **очевидный** промежуточный результат от команды. Команда должна иметь возможность 
отчитаться в любой момент о состоянии дел по разработке игры. Основное ТЗ можно посмотреть ещё раз 
[тут](#функционал-который-должен-быть-реализован), подробное ТЗ будет расписано в каждом шаге.

#### Шаги разработки:
Время на этап: **18 часов**

1. Время на работу: 6 часов  
   
   * **Разработка макета визуальной части процесса игры и части главного меню**.  
     
     Необходимо разработать подробный макет (в любом из доступных средств визуализации макетов) основного экрана игры.
     На экране должны быть: **имена игроков**, выделенные выбранными цветами; **область со способностями** игроков, где
     размещаются иконки способностей (при этом, тут же нужно найти или создать подходящие иконки); **время** игры;
     счёт игры (если это многораундовая игра); счётчик раундов (если это многораундовая игра); сама карта, по которой 
     будут передвигаться игроки, и **статический фон** карты. Очевидно, что всё это должно лаконично смотреться 
     и не "накладываться" друг на друга.
     
     Также необходимо найти **фоновую музыку** для главного меню и **динамичную** фоновую заставку для главного фона.
     Если фоновая музыка доходит до конца "дорожки", то она должна запускаться заново. Для каждой отдельной кнопки меню 
     необходимо сделать "подсвечивание" кнопки, **звук наведения** на кнопку и **звук нажатия** на кнопку. Сделать это
     необходимо в виде отдельного функционала, чтобы разработчики основного меню могли с лёгкостью добавить это в свой код.
     
   * **Разработка основного меню игры**.  
     
     Необходимо разработать основное меню игры с кнопками: **Начать**, **Настройки** и **Выход**. 
     
     Для кнопки **Начать** необходимо разработать **окно**, имеющее следующие поля:
        * имена игроков и их цвета, при этом, **нельзя** допускать одинаковых цветов, а также цветов, сливающихся с 
        фоном карты
        * количество раундов (3, 5, 7, 9) игры или поле "быстрая игра"
        * количество способностей у каждого игрока (при этом, не должно быть больше доступного на момент разработки), 
        либо "без способностей"
        * кнопку "начать игру"  
         
     Для кнопки **Выход** необходимо разработать **диалоговое окно**, спрашивающее "Хотите выйти из игры?" с вариантами
     "Да" и "Нет".
     
   * **Разработка основного меню игры и метода хранения конфигураций игры**  
     
     Для кнопки **Настройки** необходимо разработать **окно**, имеющее следующие поля:
       * выбор фона основного окна игры — необходимо открывать модальное окно выбора файла или выбор среди существующих
         фонов (на усмотрение разработчиков)
       * выбор раскладки для обоих игроков — либо раскладку задают сами игроки, либо предопределить их самостоятельно команде 
         разработчиков, но с возможностью выбора нескольких (не только WASD и "Стрелочки")
         
     Для описанных настроек необходимо продумать структуру хранения конфигов и написать для этого отдельный класс/модуль 
     для удобства обращения.
     
   Для этого шага разработки **результатом** является готовое меню с фоном, музыкой и звуком кнопок меню. Каждая кнопка
   должна открывать своё окно, а все прописываемые в окнах параметры должны записываться в соответствующие конфиги или 
   переменные программы (в том случае, если их не имеет смысла записывать в конфиг).
   
2. Время на работу: **4 часа**  
   
   * **Визуализация окна игры**  
     
     На этом шаге необходимо отобразить на экран всё то, что было нанесено на макет на предыдущем шаге. На экране могут 
     быть "заглушки". Главное, чтобы был реализован такой функционал, который позволит другому члену команды использовать
     прописанные игроками параметры (имена, цвета, способности и т.д.), чтобы связать визуализацию с логикой.  
     
   * **Привязка визуальной составляющей с логикой игры**  
     
     Необходимо написать функционал, который позволяет получать параметры, вводимые игроками на предыдущем шаге, чтобы 
     использовать их для визуализации на экране и для реализации логики игры. Здесь необходимо параллельное 
     взаимодействие первых двух членов команды, чтобы по итогу полученные на предыдущем шаге параметры 
     игроков корректно отображались на экране игры.  
     
   * **Написание логики движения игроков**
     
     Необходимо написать функционал, который отображает на экране двух игроков (на данном шаге не важен цвет) в 
     случайных местах на карте и заставляет их двигаться прямо. Необходимо написать функционал, позволяющий управлять 
     игроками на карте (на данном шаге не важна раскладка — пропишите их "по-умолчанию"). Необходимо, чтобы игроки 
     оставляли за собой **след**, а также могли двигаться за пределы карты: если игрок зашёл за границу карты, он просто
     появляется на противоположной стороне и продолжает движение.

   Для этого шага разработки **результатом** является основное окно игры с отображенными параметрами на экране: имена 
   игроков, выделенные выбранными ими цветами; способности (если имеются); время игры; основная карта с игроками на ней.
   Также должна быть реализована логика движения игроков с возможностью управления двумя разными раскладками 
   (чтобы могли играть двое) и возможностью выхода игроков за границы карты.
   
3. Время на работу: **5 часов**
   
   * **Реализация логики столкновения игроков и дополнения к игре**  
     
     Необходимо реализовать логику, когда игроки сталкиваются со следом противника, либо со своим следом — оба случая
     означают проигрыш игрока. Здесь же нужно обработать ситуацию, когда игроки сталкиваются "лоб в лоб" — ничья.
     
     На этом же шаге необходимо добавить фоновое изображение и музыкальное сопровождение, при этом, лучше всего, если 
     оно будет меняться. Но обязательно необходимо, чтобы музыка возобновлялась после проигрывания всего плейлиста.
     
     Также необходимо реализовать возможность различной раскладки клавиатуры для разных игроков. На прошлом шаге стояло
     значение по-умолчанию. Теперь необходимо учесть задание параметров раскладки из поля **Настройки** в главном меню.
     
   * **Реализация диалогового окна паузы**  
    
     Необходимо реализовать диалоговое окно, которое будет появляться при нажатии клавиши "ESC". На диалоговом окне 
     необходимо отобразить:
       * кнопку **Возобновить игру**, которая вернет игру в прежнее состояние, а время игры продолжится
       * надпись **имени** (в **цвете** игрока) игрока, поставившего игру на паузу
       * время игры на момент паузы
       * счёт игры, в случае игры с несколькими раундами, а не быстрой игры
       * кнопка **Выйти из игры**, возвращающая игроков в главное меню
       * кнопка **Рестарт**, начинающая игру с самого начала, сохраняя все заданные параметры, но обнуляя время, карту 
         и т.п. Стартовая расстановка игроков на карте тоже обновляется — игроки расставляются случайно.
     
   * **Реализация диалогового окна по завершению игры**  
    
     Необходимо написать диалоговое окно, которое вызывается в случае завершения игры или раунда. При этом, для двух 
     ситуаций диалоговые окна отличаются. В случае, когда был сыгран один из раундов (когда играется многораундовая игра), 
     но не конечный, то отображается временное окно, в котором указывается:
       * **имя** и **цвет** победителя раунда
       * **счёт игры**
       * **время** раунда
    
     Временное окно должно исчезать через какое-то разумное время (можно добавить эффект "растворения" окна, когда 
     постепенно снижается его прозрачность), игроки должны расставляться заново случайно, время обновляться, а счётчик
     раундов и сам счёт — изменяться.
    
     В случае, когда сыграна **быстрая** игра или это был финальный раунд **многораундовой** игры, необходимо показывать 
     диалоговое окно, в котором указывается:
       * **имя** и **цвет** победителя игры
       * **счёт игры**, если это игра с несколькими раундами (в случае быстрой игры этот пункт не учитывать)
       * **суммарное время** игры (сумма времени всех раундов) 
       * кнопка **Выйти из игры**, возвращающая игроков в главное меню
       * кнопка **Рестарт**, начинающая игру с самого начала, сохраняя все заданные параметры, но обнуляя время, карту
         и т.п. Стартовая расстановка игроков на карте тоже обновляется — игроки расставляются случайно.
       
     Важно учесть, что многораундовая игра может закончиться раньше, чем количество раундов (к примеру, когда раундов 5, 
     а один из игроков выиграл уже 3 раунда подряд, тогда доигрывать 2 раунда не имеет смысла).

   Для этого шага разработки **результатом** является реализованная логика передвижения игроков, их столкновения,
   а также вывод всех сопутствующих **работающих** диалоговых окон в случае завершения игры/раунда или паузы (нажатие 
   на клавишу "ESC"). При этом, должно работать изменение раскладки для игроков, задаваемое в **Настройках** игры, а 
   также изменение счётчика раундов и счёта (в случае многораундовой игры). На этом шаге игра должна выглядеть готовой 
   для комфортной **быстрой** или **многораундовой** игры вдвоем. На фоне должно быть выбранное изображение, а при игре 
   (не во время паузы) — фоновая музыка.

4. Время на работу: **3 часа**
   * **Доделывание логики столкновений**  
    
     Необходимо прибавлять очко за раунд (если это многораундовая игра) обоим игрокам, если произошло столкновение 
     "лоб в лоб". При этом, если по итогу игры произошла ничья по счёту, то в диалоговом окне также должна выводиться 
     "ничья".
     
     На этом же шаге необходимо реализовать отображение способностей игроков ровно в том количестве, которое было задано
     перед стартом игры. При этом, если задано, к примеру, по 1 способности у каждого игрока, а всего способностей в 
     игре 3, то способность выбирается **случайно** для каждого игрока. Важно учесть, что способность может быть 
     использована **только 1 раз** за раунд.
     
     Необходимо реализовать функционал, обеспечивающий затемнение (необходимо сделать иконку серой) иконки способности 
     в том случае, если она была использована игроком.
     
   * **Создание способности замедления своего персонажа**  
      
     Необходимо реализовать функционал, обеспечивающий запуск способности **замедления** своего персонажа (насколько — 
     выбор разработчиков). При этом, необходимо предусмотреть новые клавишу в раскладках для способностей. 
     
     При нажатии на специальную клавишу игрок должен замедлять своё движение на сколько-то процентов на какое-то время. 
     После этого скорость его движения должна возобновляться.

   * **Создание способности ускорения персонажа противника**

     Необходимо реализовать функционал, обеспечивающий запуск способности **ускорения** персонажа противника (насколько —
     выбор разработчиков). При этом, необходимо предусмотреть новые клавишу в раскладках для способностей.

     При нажатии на специальную клавишу игрок должен ускорять движение противника на сколько-то процентов на какое-то время.
     После этого скорость его движения должна возобновляться.  

   Для этого шага разработки **результатом** является полноценная игра с возможностью использования способностей, 
   изменения различных настроек игры, а также корректная логика игры в случае столкновения "лоб в лоб".


## Этап II

### Цель

Необходимо разработать многопользовательскую (на 2 клиента) версию 2D-игры "Трон".

В этот этап необходимо включить:
* добавление случайных препятствий на карту
* запись статистики в бд по игрокам и вывод статистики при нажатии клавиши **Статистика** в главном меню
* мультиплеер — когда игра запускается на двух разных клиентах, а подключение происходит по сети
* добавление новых способностей:
   * неуязвимость к чужому следу
   * блокировка способностей противника
