# Долгосрочное домашнее задание ("Фоторедактор")

Состоит из 7-8 различных по сложности этапов, каждый этап - это небольшое домашнее задание, которое необходимо сдать. Работа ведётся в группах по 3 человека.

### Инструменты

1. Для реализации графики использовать либо [рассмотренную ранее библиотеку SFML](pz06-GUI-SFML.md), либо Qt
1. Для реализации запросов использовать рассмотренную [библиотеку cpr](pz08-requests.md)  
1. Для реализации серверной части руководствоваться либо [ПЗ по реализации HTTP сервера на crow](pz09-http-server.md), либо использовать многопоточный TCP сервер на Poco  
1. В качестве БД можно использовать SQLite. Для работы с ней можно использовать как классические средства языка C++ - [ПЗ по sqlite](pz10-SQLite.md), либо посмотреть решения поновее - например, [это](https://github.com/fnc12/sqlite_orm)  
1. Для работы с изображениями использовать OpenCV    

### Задание

**Цель:** Разработать приложение, реализующее функционал фоторедактора.

Описание задания:

1. Приложение должно быть построено по клиент-серверной архитектуре.
2. Клиентская часть состоит из двух модулей: отрисовка пользовательского интерфейса и взаимодействие с сервером. При этом пользовательский интерфейс должен поддерживать:
    - окно авторизации в приложении (пользователь вводит свой username и пароль - если пользователя еще нет в базе, он в нее добавляется). С каждым пользователем должен существовать токен доступа, по которому сервер будет его идентифицировать (токен передается в запросах с клиента)

        > **Запрещено хранить пароль в БД в открытом виде** - в базе должна хранится salt и хеш пароля (например, sha256(pass + salt)). В случае данного задания можно успользовать упрощенную схему и хранить в БД в качестве пароля следующий хэш: **password_hash = h(password + h(username)), где h - выбранная хэшфункция**

    - окно с информацией о загруженных на сервер изображениях, для каждого из которых:
        - выводятся методанные (название, расширение, время добавления, время последнего изменения, размер)
        - с помощью интерфейса реализована возможность редактирования в редакторе, удаления с сервера, выгрузка с сервера

        Также в данном окне должна быть реализована возможность загрузки нового изображения на сервер

    - окно с выбранным изображением, в котором должно быть реализовано следующее:
        - различные методы обработки, связанные с:
            - изменением конраста и резкости изображения (должны задаваться скроллерами)
            - наложением фильтров:
                - сепия
                - черно-белый
                - негатив
    - возможность сохранения исходных изменений
    - кнопка возврата к списку изображений
    - возможности отмены совершенного изменения
3. Серверная часть может быть реализована либо с помощью библиотеки Poco (см предоставленный базовый класс многопоточного TCP - сервера из ПЗ "Многопоточный TCP сервер"), либо с помощью библиотеки crow (см пз "HTTP Server" (что тоже является TCP сервером, просто ПЗ называется иначе хд)). Обработка изображений ведется на стороне сервера.
4. Данные о пользователях и изображениях должны хванится в базе. Формат хранения определяется разработчиками.

### Клиентская и серверная части

Далее перечислены основные пункты задания на разработку приложения:

Графическая часть:

1. Окно авторизации - отрисовка окна
2. Окно со списком изображений - отображение информации об изображениях с методанными (само изображение выводить не надо)
3. Окно со списком изображений - отображение для каждого изображения из списка кнопок удаления, редактирования и выгрузки с сервер  
4. Окно редактирования изображения - окно с изображением, каркас боковой панели с методами обработки
5. Окно редактирования изображения - кнопки сохранения исходных изменений, возврата к списку изображений и отмены совершенного изменения
6. Окно редактирования изображения - кнопки и скроллеры для изменением конраста и резкости изображения
7. Окно редактирования изображения - кнопки для применения фильтров (сепия, черно-белый, негатив) 

Клиентская часть:

1. Отправка запроса авторизации на сервер
2. Отправка запроса на получение с сервера списка всех изображений пользователя
3. Отправка запроса на получение с сервера изображения
4. Отправка запроса на удаление изображения с сервера
5. Отмена совершенного изменения (для этого перед совершением изменения следует кешировать прошлое состояние изображения). 
6. Отправка изображения на сервер с параметрами обработки - фильтр/способ обработки с заданной интенсивностью (например, для резкости) (сервер должен вернуть обработанное изображение)

Серверная часть:

1. Разработка базы данных(таблицы,связи между таблицами).
2. Реализация класса для работы с пользователями, хранящимися в базе (интерфейс по аналогии с классом UserManager из ПЗ по HTTP серверу)
3. Реализация класса для работы с изображениями, хранящимися в базе (интерфейс по аналогии с классом UserManager из ПЗ по HTTP серверу)
4. Реализация класса, реализующего обработку изображений по заданному фильтру (сепия, черно-белый, негатив)
5. Реализация класса, реализующего обработку с параметром интенсивности (конраст, резкость)
6. Реализации эндпоинта, реализующего авторизацию пользователя (и его добавление в базу в случае, если пользователя нет).
7. Реализция эндпоинта, возвращающего информацию об изображениях пользователя, хранящихся на сервере
8. Реализация эндпоинта, возвращающего изображение 
9. Реализация эндпоинта, реализующего обработку изображения и его отправку обратно

### Индивидуальные задания

Каждому участнику команды будет необходимо выполнить по 6-8 заданий разной степени сложности.

Первый участник команды выполняет следующие задания:

1. Разработка базы данных(таблицы,связи между таблицами). (серверная)
2. Реализция эндпоинта, возвращающего информацию об изображениях пользователя, хранящихся на сервере (серверная)
3. Отправка запроса на получение с сервера списка всех изображений пользователя (клиентская)
4. Окно авторизации - отрисовка окна (графическая)
5. Отправка запроса на удаление изображения с сервера (клиентская)
6. Реализация класса, реализующего обработку изображений по заданному фильтру (сепия, черно-белый, негатив) (серверная)
7. Реализация эндпоинта, реализующего обработку изображения и его отправку обратно (серверная)
8. Окно редактирования изображения - кнопки для применения фильтров (сепия, черно-белый, негатив) (графическая)

Второй участник команды выполняет следующие задания:

1. Реализация класса для работы с пользователями, хранящимися в базе (серверная)
2. Реализация эндпоинта, возвращающего изображение (серверная)
3. Отправка запроса авторизации на сервер (клиентская)
4. Окно со списком изображений - отображение для каждого изображения из списка кнопок удаления, редактирования и выгрузки с сервер (графическая)
5. Отмена совершенного изменения (для этого перед совершением изменения следует кешировать прошлое состояние изображения) (клиентская)
6. Реализация класса, реализующего обработку с параметром интенсивности (конраст, резкость) (серверная)
7. Окно редактирования изображения - кнопки сохранения исходных изменений, возврата к списку изображений и отмены совершенного изменения (графическая)

Третий участник команды выполняет следующие задания:

1. Реализация класса для работы с изображениями, хранящимися в базе (интерфейс по аналогии с классом UserManager из ПЗ по HTTP серверу) (серверная)
2. Реализации эндпоинта, реализующего авторизацию пользователя (серверная)
3. Окно со списком изображений - отображение информации об изображениях с методанными. (графическая)
4. Отправка запроса на удаление изображения с сервера (клиентская)
5. Отправка изображения на сервер с параметрами обработки - фильтр/способ обработки с заданной интенсивностью (например, для резкости) (сервер должен вернуть обработанное изображение) (клиентская)
6. Окно редактирования изображения - окно с изображением, каркас боковой панели с методами обработки (графическая)
7. Окно редактирования изображения - кнопки и скроллеры для изменением конраста и резкости изображения

Задания на каждом этапе связаны. Выполнение следующего задания начинается только после того, как все участники команды закроют своё задание на текущем этапе.

